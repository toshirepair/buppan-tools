<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãƒãƒ«ãƒã‚µã‚¤ãƒˆä¸€æ‹¬ãƒªã‚µãƒ¼ãƒãƒ„ãƒ¼ãƒ«</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 16px;
      line-height: 1.6;
    }
    h1 {
      font-size: 1.4rem;
      margin-bottom: 0.5rem;
    }
    .card {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 16px;
      margin-top: 12px;
    }
    label {
      display: inline-block;
      margin-right: 12px;
      margin-bottom: 4px;
    }
    input[type="text"] {
      width: 100%;
      padding: 8px;
      font-size: 1rem;
      box-sizing: border-box;
    }
    button {
      padding: 10px 18px;
      font-size: 1rem;
      cursor: pointer;
      border-radius: 6px;
      border: none;
      background: #2563eb;
      color: #fff;
      margin-top: 12px;
    }
    button:disabled {
      background: #9ca3af;
      cursor: default;
    }
    .small {
      font-size: 0.85rem;
      color: #555;
    }
    ul.result-list {
      list-style: none;
      padding-left: 0;
      margin: 0;
      margin-top: 8px;
    }
    ul.result-list li {
      margin-bottom: 10px;
    }
    a.result-link {
      font-size: 0.95rem;
      text-decoration: underline;
      color: #2563eb;
    }
    textarea.copy-area {
      width: 100%;
      min-height: 120px;
      box-sizing: border-box;
      font-size: 0.85rem;
      margin-top: 8px;
      white-space: pre-wrap;
    }
  </style>
</head>

<body>
  <h1>ãƒãƒ«ãƒã‚µã‚¤ãƒˆä¸€æ‹¬ãƒªã‚µãƒ¼ãƒãƒ„ãƒ¼ãƒ«</h1>

  <div class="card">
    <!-- Googleãƒ¬ãƒ³ã‚ºãƒœã‚¿ãƒ³ -->
    <div>
      <button
        type="button"
        id="openGoogleLensBtn"
        style="background:#6b7280; color:#fff; padding:10px 18px; border-radius:6px; border:none; cursor:pointer;"
      >
        Googleãƒ¬ãƒ³ã‚ºã‚’é–‹ã
      </button>
    </div>

    <!-- ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼‹ã‚¯ãƒªã‚¢ -->
    <div style="margin-top: 12px;">
      <label for="keyword"><strong>å‹ç•ªï¼ˆãƒ™ãƒ¼ã‚¹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼‰</strong></label>

      <div style="display:flex; gap:8px; align-items:center;">
        <input type="text" id="keyword" placeholder="ä¾‹ï¼šNikon D750 50mm f1.8 ãªã©" style="flex:1;">
        <button
          type="button"
          id="clearKeywordBtn"
          style="background:#6b7280; color:#fff; margin-top:0; white-space:nowrap;"
        >
          ã‚¯ãƒªã‚¢
        </button>
      </div>
    </div>

    <!-- çŠ¶æ…‹ -->
    <div style="margin-top: 12px;">
      <div><strong>çŠ¶æ…‹ï¼ˆãƒ¤ãƒ•ã‚ªã‚¯ãƒ»ãƒ¡ãƒ«ã‚«ãƒªãƒ»ãƒ©ã‚¯ãƒãƒ»eBay ã«åæ˜ ï¼‰</strong></div>
      <label><input type="checkbox" id="cond_new"> æ–°å“</label>
      <label><input type="checkbox" id="cond_mint" checked> ç¾å“</label>
      <label><input type="checkbox" id="cond_exc"> ä¸¦å“</label>
      <label><input type="checkbox" id="cond_read"> è¨³ã‚ã‚Š</label>
      <label><input type="checkbox" id="cond_now"> ç¾çŠ¶</label>
      <label><input type="checkbox" id="cond_asis"> ã‚¸ãƒ£ãƒ³ã‚¯</label>

      <!-- ä»˜å±å“ãƒ»ç‰¹å¾´ -->
      <div style="margin-top: 10px;"><strong>ä»˜å±å“ãƒ»ç‰¹å¾´</strong></div>
      <label><input type="checkbox" id="feat_box"> ç®±ä»˜ã</label>
      <label><input type="checkbox" id="feat_hood"> ãƒ•ãƒ¼ãƒ‰ä»˜ã</label>
      <label><input type="checkbox" id="feat_early"> åˆæœŸ</label>
      <label><input type="checkbox" id="feat_pre"> å‰æœŸ</label>
      <label><input type="checkbox" id="feat_post"> å¾ŒæœŸ</label>
    </div>

    <!-- æ¤œç´¢ã‚µã‚¤ãƒˆ -->
    <div style="margin-top: 12px;">
      <div><strong>æ¤œç´¢ã™ã‚‹ã‚µã‚¤ãƒˆ</strong></div>

      <!-- eBay -->
      <label><input type="checkbox" id="useEbayAR" checked> eBay(AR)</label>
      <label><input type="checkbox" id="useEbayPR" checked> eBay(PR)</label>
      <label><input type="checkbox" id="useEbayPRDDU" checked> eBay(PR:ãƒˆãƒ©ãƒ³ãƒ—é–¢ç¨ç„¡ã—DDUæ™‚ä»£ 90days)</label><br>

      <!-- å›½å†… -->
      <label><input type="checkbox" id="useYahu" checked> ãƒ¤ãƒ•ã‚ªã‚¯</label>
      <label><input type="checkbox" id="useMercari" checked> ãƒ¡ãƒ«ã‚«ãƒª</label>
      <label><input type="checkbox" id="useRakuma"> ãƒ©ã‚¯ãƒ</label><br>

      <!-- ãã®ä»– -->
      <label><input type="checkbox" id="useYahuShop"> ãƒ¤ãƒ•ãƒ¼ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°</label><br>
      <label><input type="checkbox" id="useAmaJP"> Amazon.co.jp</label>
      <label><input type="checkbox" id="useAmaUS"> Amazon.com</label><br>
      <label><input type="checkbox" id="useEtsy"> Etsy</label>
      <label><input type="checkbox" id="useCata"> Catawiki</label>

      <div class="small" style="margin-top:4px;">
        â€» PCã§ã‚‚ã‚¹ãƒãƒ›ã§ã‚‚ã€ãƒªãƒ³ã‚¯ã¯ä¸‹éƒ¨ã«ä¸€è¦§è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
      </div>
    </div>

    <button id="runBtn">æ¤œç´¢</button>
  </div>

  <div id="result" class="card" style="display:none; margin-top:16px;">
    <strong>ãƒªãƒ³ã‚¯ä¸€è¦§ï¼ˆã‚¹ãƒãƒ›ï¼PCå…±é€šï¼‰</strong>
    <div id="resultLinks" class="small" style="margin-top:8px;"></div>
  </div>

  <script>
    // =========================================================
    // â˜… å›ºå®šï¼šæ™‚é–“å‰µå‡ºã¯å¸¸ã«106ç§’ï¼ˆãƒã‚§ãƒƒã‚¯çŠ¶æ³ã«é–¢ä¿‚ãªãå›ºå®šï¼‰
    // =========================================================
    const CREATED_SECONDS_FIXED = 106;

    // ãŠã¾ã‘æ›ç®—ï¼ˆå›ºå®šï¼‰
    const DAILY_SEARCH_COUNT = 10;
    const HOURLY_WAGE = 1500;
    const REPAIR_PER_HOUR = 1;
    const PROFIT_PER_REPAIR = 5000;
    const PRIVATE_HOURS_PER_DAY = 7;

    // =========================================================
    // Googleãƒ¬ãƒ³ã‚º
    // =========================================================
    const openGoogleLensBtn = document.getElementById("openGoogleLensBtn");
    if (openGoogleLensBtn) {
      openGoogleLensBtn.addEventListener("click", () => {
        const ua = navigator.userAgent.toLowerCase();
        const isMobile = /iphone|ipad|ipod|android/.test(ua);
        const isIOS = /iphone|ipad|ipod/.test(ua);

        if (!isMobile) {
          window.open("https://lens.google.com/", "_blank", "noopener");
          return;
        }
        if (!isIOS) {
          window.open("https://lens.google.com/", "_blank", "noopener");
          return;
        }
        window.location.href = "google://";
      });
    }

    // =========================================================
    // ã‚¯ãƒªã‚¢ãƒœã‚¿ãƒ³
    // =========================================================
    document.getElementById("clearKeywordBtn").addEventListener("click", () => {
      const keywordInput = document.getElementById("keyword");
      keywordInput.value = "";
      keywordInput.focus();

      // çµæœã‚’é–‰ã˜ã‚‹
      document.getElementById("result").style.display = "none";
      document.getElementById("resultLinks").innerHTML = "";
    });

    // =========================================================
    // æ¤œç´¢å‡¦ç†
    // =========================================================
    function runSearch() {
      const keywordInput = document.getElementById("keyword");
      const baseWord = keywordInput.value.trim();

      if (!baseWord) {
        alert("å‹ç•ªï¼ˆãƒ™ãƒ¼ã‚¹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
        keywordInput.focus();
        return;
      }

      // çŠ¶æ…‹ãƒã‚§ãƒƒã‚¯
      const condNew  = document.getElementById("cond_new").checked;
      const condMint = document.getElementById("cond_mint").checked;
      const condExc  = document.getElementById("cond_exc").checked;
      const condRead = document.getElementById("cond_read").checked;
      const condNow  = document.getElementById("cond_now").checked;
      const condAsis = document.getElementById("cond_asis").checked;

      // ä»˜å±å“ãƒ»ç‰¹å¾´
      const featBox   = document.getElementById("feat_box").checked;
      const featHood  = document.getElementById("feat_hood").checked;
      const featEarly = document.getElementById("feat_early").checked;
      const featPre   = document.getElementById("feat_pre").checked;
      const featPost  = document.getElementById("feat_post").checked;

      // ã‚µã‚¤ãƒˆé¸æŠ
      const useEbayAR    = document.getElementById("useEbayAR").checked;
      const useEbayPR    = document.getElementById("useEbayPR").checked;
      const useEbayPRDDU = document.getElementById("useEbayPRDDU").checked;

      const useYahu      = document.getElementById("useYahu").checked;
      const useMercari   = document.getElementById("useMercari").checked;
      const useRakuma    = document.getElementById("useRakuma").checked;

      const useYahuShop  = document.getElementById("useYahuShop").checked;
      const useAmaJP     = document.getElementById("useAmaJP").checked;
      const useAmaUS     = document.getElementById("useAmaUS").checked;
      const useEtsy      = document.getElementById("useEtsy").checked;
      const useCata      = document.getElementById("useCata").checked;

      if (!useEbayAR && !useEbayPR && !useEbayPRDDU &&
          !useYahu && !useMercari && !useRakuma &&
          !useYahuShop && !useAmaJP && !useAmaUS &&
          !useEtsy && !useCata) {
        alert("å°‘ãªãã¨ã‚‚1ã¤ã®ã‚µã‚¤ãƒˆã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚");
        return;
      }

      const hasCondition = condNew || condMint || condExc || condRead || condNow || condAsis;

      // çŠ¶æ…‹ãƒªã‚¹ãƒˆï¼ˆeBayç”¨ã®è‹±èªãƒ»æ—¥æœ¬ã‚µã‚¤ãƒˆç”¨ã®æ—¥æœ¬èªãƒ»ãƒ©ãƒ™ãƒ«ï¼‰
      const conds = [];
      if (condNew)  conds.push({ jp: "æ–°å“",   en: "new",   labelJP: "ï¼ˆæ–°å“ï¼‰",   labelEN: "ï¼ˆnewï¼‰" });
      if (condMint) conds.push({ jp: "ç¾å“",   en: "mint",  labelJP: "ï¼ˆç¾å“ï¼‰",   labelEN: "ï¼ˆmintï¼‰" });
      if (condExc)  conds.push({ jp: "ä¸¦å“",   en: "exc",   labelJP: "ï¼ˆä¸¦å“ï¼‰",   labelEN: "ï¼ˆexcï¼‰" });
      if (condRead) conds.push({ jp: "è¨³ã‚ã‚Š", en: "read",  labelJP: "ï¼ˆè¨³ã‚ã‚Šï¼‰", labelEN: "ï¼ˆreadï¼‰" });
      if (condNow)  conds.push({ jp: "ç¾çŠ¶",   en: "asis",  labelJP: "ï¼ˆç¾çŠ¶ï¼‰",   labelEN: "ï¼ˆasisï¼‰" });
      if (condAsis) conds.push({ jp: "ã‚¸ãƒ£ãƒ³ã‚¯", en: "parts", labelJP: "ï¼ˆã‚¸ãƒ£ãƒ³ã‚¯ï¼‰", labelEN: "ï¼ˆpartsï¼‰" });

      // ä»˜å±å“ãƒ»ç‰¹å¾´ï¼šæ¤œç´¢èªã«è¿½åŠ ï¼ˆåŒæ™‚é¸æŠã¯å…¨éƒ¨è¶³ã™ï¼‰
      const addJP = [];
      const addEN = [];
      const addLabelJP = [];
      const addLabelEN = [];

      if (featBox)   { addJP.push("ç®±");     addEN.push("box");  addLabelJP.push("ç®±ä»˜ã");     addLabelEN.push("box"); }
      if (featHood)  { addJP.push("ãƒ•ãƒ¼ãƒ‰"); addEN.push("hood"); addLabelJP.push("ãƒ•ãƒ¼ãƒ‰ä»˜ã"); addLabelEN.push("hood"); }
      if (featEarly) { addJP.push("åˆæœŸ");   addEN.push("early");addLabelJP.push("åˆæœŸ");       addLabelEN.push("early"); }
      if (featPre)   { addJP.push("å‰æœŸ");   addEN.push("early");addLabelJP.push("å‰æœŸ");       addLabelEN.push("early"); }
      if (featPost)  { addJP.push("å¾ŒæœŸ");   addEN.push("late"); addLabelJP.push("å¾ŒæœŸ");       addLabelEN.push("late"); }

      // è¡¨ç¤ºç”¨ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹
      function buildSuffixJP(condLabelJP) {
        const extras = addLabelJP.length ? addLabelJP.join(" ") : "";
        const extraWrapped = extras ? `ï¼ˆ${extras}ï¼‰` : "";
        return (condLabelJP || "") + extraWrapped;
      }
      function buildSuffixEN(condLabelEN) {
        const extras = addLabelEN.length ? addLabelEN.join(" ") : "";
        const extraWrapped = extras ? `ï¼ˆ${extras}ï¼‰` : "";
        return (condLabelEN || "") + extraWrapped;
      }

      // ã‚¯ã‚¨ãƒªçµ„ã¿ç«‹ã¦
      function buildJPQuery(base, condJP) {
        let q = base;
        if (condJP) q += " " + condJP;
        if (addJP.length) q += " " + addJP.join(" ");
        return q.trim();
      }
      function buildENQuery(base, condEN) {
        let q = base;
        if (condEN) q += " " + condEN;
        if (addEN.length) q += " " + addEN.join(" ");
        return q.replace(/\s+/g, " ").trim();
      }

      const links = [];

      // eBay(AR) SOLD é«˜ã„é †
      if (useEbayAR) {
        const baseEbayAR =
          "https://www.ebay.com/sch/i.html?_nkw=TESTWORD&_sacat=0&_from=R40&LH_Sold=1&LH_Complete=1&_sop=16";

        if (hasCondition) {
          conds.forEach(c => {
            const word = encodeURIComponent(buildENQuery(baseWord, c.en));
            links.push({ label: "eBay(AR)" + c.labelEN + buildSuffixEN(""), url: baseEbayAR.replace("TESTWORD", word) });
          });
        } else {
          const word = encodeURIComponent(buildENQuery(baseWord, ""));
          links.push({ label: "eBay(AR)" + buildSuffixEN(""), url: baseEbayAR.replace("TESTWORD", word) });
        }
      }

      // eBay(PR) 90æ—¥
      if (useEbayPR) {
        const baseEbayPR =
          "https://www.ebay.com/sh/research?marketplace=EBAY-US&keywords=TESTWORD&dayRange=90&categoryId=0&offset=0&limit=50&sorting=-avgsalesprice&tabName=SOLD&tz=Asia%2FTokyo";

        if (hasCondition) {
          conds.forEach(c => {
            const word = encodeURIComponent(buildENQuery(baseWord, c.en));
            links.push({ label: "eBay(PR)" + c.labelEN + buildSuffixEN(""), url: baseEbayPR.replace("TESTWORD", word) });
          });
        } else {
          const word = encodeURIComponent(buildENQuery(baseWord, ""));
          links.push({ label: "eBay(PR)" + buildSuffixEN(""), url: baseEbayPR.replace("TESTWORD", word) });
        }
      }

      // eBay(PR DDUæ™‚ä»£å›ºå®šæœŸé–“)
      if (useEbayPRDDU) {
        const baseEbayPRDDU =
          "https://www.ebay.com/sh/research?marketplace=EBAY-US&keywords=TESTWORD&dayRange=CUSTOM&endDate=1743346800000&startDate=1735657200000&categoryId=0&offset=0&limit=50&sorting=-avgsalesprice&tabName=SOLD&tz=Asia%2FTokyo";

        if (hasCondition) {
          conds.forEach(c => {
            const word = encodeURIComponent(buildENQuery(baseWord, c.en));
            links.push({
              label: "eBay(PR:ãƒˆãƒ©ãƒ³ãƒ—é–¢ç¨ç„¡ã—DDUæ™‚ä»£ 90days)" + c.labelEN + buildSuffixEN(""),
              url: baseEbayPRDDU.replace("TESTWORD", word)
            });
          });
        } else {
          const word = encodeURIComponent(buildENQuery(baseWord, ""));
          links.push({
            label: "eBay(PR:ãƒˆãƒ©ãƒ³ãƒ—é–¢ç¨ç„¡ã—DDUæ™‚ä»£ 90days)" + buildSuffixEN(""),
            url: baseEbayPRDDU.replace("TESTWORD", word)
          });
        }
      }

      // ãƒ¤ãƒ•ã‚ªã‚¯ï¼ˆè½æœ­ç›¸å ´ï¼‰
      if (useYahu) {
        const baseYahu =
          "https://auctions.yahoo.co.jp/closedsearch/closedsearch?p=TESTWORD&va=TESTWORD&b=1&n=100&select=2";

        if (hasCondition) {
          conds.forEach(c => {
            const word = encodeURIComponent(buildJPQuery(baseWord, c.jp));
            links.push({ label: "ãƒ¤ãƒ•ã‚ªã‚¯è½æœ­ç›¸å ´" + c.labelJP + buildSuffixJP(""), url: baseYahu.replace(/TESTWORD/g, word) });
          });
        } else {
          const word = encodeURIComponent(buildJPQuery(baseWord, ""));
          links.push({ label: "ãƒ¤ãƒ•ã‚ªã‚¯è½æœ­ç›¸å ´" + buildSuffixJP(""), url: baseYahu.replace(/TESTWORD/g, word) });
        }
      }

      // ãƒ¡ãƒ«ã‚«ãƒªï¼ˆå£²ã‚Šåˆ‡ã‚Œï¼‰
      if (useMercari) {
        const baseMercari =
          "https://jp.mercari.com/search?keyword=TESTWORD&status=sold_out%7Ctrading&sort=price&order=desc";

        if (hasCondition) {
          conds.forEach(c => {
            const word = encodeURIComponent(buildJPQuery(baseWord, c.jp));
            links.push({ label: "ãƒ¡ãƒ«ã‚«ãƒªï¼ˆå£²ã‚Šåˆ‡ã‚Œï¼‰" + c.labelJP + buildSuffixJP(""), url: baseMercari.replace("TESTWORD", word) });
          });
        } else {
          const word = encodeURIComponent(buildJPQuery(baseWord, ""));
          links.push({ label: "ãƒ¡ãƒ«ã‚«ãƒªï¼ˆå£²ã‚Šåˆ‡ã‚Œï¼‰" + buildSuffixJP(""), url: baseMercari.replace("TESTWORD", word) });
        }
      }

      // ãƒ©ã‚¯ãƒï¼ˆå£²ã‚Šåˆ‡ã‚Œï¼‰
      if (useRakuma) {
        const baseRakuma =
          "https://fril.jp/s?order=desc&query=TESTWORD&sort=sell_price&transaction=soldout";

        if (hasCondition) {
          conds.forEach(c => {
            const word = encodeURIComponent(buildJPQuery(baseWord, c.jp));
            links.push({ label: "ãƒ©ã‚¯ãƒï¼ˆå£²ã‚Šåˆ‡ã‚Œï¼‰" + c.labelJP + buildSuffixJP(""), url: baseRakuma.replace("TESTWORD", word) });
          });
        } else {
          const word = encodeURIComponent(buildJPQuery(baseWord, ""));
          links.push({ label: "ãƒ©ã‚¯ãƒï¼ˆå£²ã‚Šåˆ‡ã‚Œï¼‰" + buildSuffixJP(""), url: baseRakuma.replace("TESTWORD", word) });
        }
      }

      // ãƒ¤ãƒ•ãƒ¼ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°ï¼ˆçŠ¶æ…‹ã¯ä»˜ã‘ãªã„ / ä»˜å±å“ãƒ»ç‰¹å¾´ã¯ä»˜ä¸ï¼‰
      if (useYahuShop) {
        const baseYahuShop =
          "https://shopping.yahoo.co.jp/search?first=1&tab_ex=commerce&fr=shp-prop&mcr=61c1e36d2245f2f47a36cdc31b5de2df&sretry=1&p=TESTWORD";
        const query = (baseWord + (addJP.length ? " " + addJP.join(" ") : "")).trim();
        links.push({ label: "ãƒ¤ãƒ•ãƒ¼ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°" + buildSuffixJP(""), url: baseYahuShop.replace("TESTWORD", encodeURIComponent(query)) });
      }

      // Amazon.co.jpï¼ˆçŠ¶æ…‹ã¯ä»˜ã‘ãªã„ / ä»˜å±å“ãƒ»ç‰¹å¾´ã¯ä»˜ä¸ï¼‰
      if (useAmaJP) {
        const baseAmaJP = "https://www.amazon.co.jp/s?k=TESTWORD";
        const query = (baseWord + (addJP.length ? " " + addJP.join(" ") : "")).trim();
        links.push({ label: "Amazon.co.jp" + buildSuffixJP(""), url: baseAmaJP.replace("TESTWORD", encodeURIComponent(query)) });
      }

      // Amazon.comï¼ˆçŠ¶æ…‹ã¯ä»˜ã‘ãªã„ / ä»˜å±å“ãƒ»ç‰¹å¾´ã¯ä»˜ä¸ï¼‰
      if (useAmaUS) {
        const baseAmaUS = "https://www.amazon.com/s?k=TESTWORD";
        const query = buildENQuery(baseWord, "");
        links.push({ label: "Amazon.com" + buildSuffixEN(""), url: baseAmaUS.replace("TESTWORD", encodeURIComponent(query)) });
      }

      // Etsyï¼ˆçŠ¶æ…‹ã¯ä»˜ã‘ãªã„ï¼‰
      if (useEtsy) {
        const baseEtsy = "https://www.etsy.com/jp/search?q=TESTWORD&order=price_desc";
        const query = buildENQuery(baseWord, "");
        links.push({ label: "Etsyï¼ˆä¾¡æ ¼é«˜ã„é †ï¼‰" + buildSuffixEN(""), url: baseEtsy.replace("TESTWORD", encodeURIComponent(query)) });
      }

      // Catawikiï¼ˆçŠ¶æ…‹ã¯ä»˜ã‘ãªã„ï¼‰
      if (useCata) {
        const baseCata = "https://www.catawiki.com/en/s?q=TESTWORD";
        const query = buildENQuery(baseWord, "");
        links.push({ label: "Catawiki" + buildSuffixEN(""), url: baseCata.replace("TESTWORD", encodeURIComponent(query)) });
      }

      renderLinks(links, baseWord);
    }

    document.getElementById("runBtn").addEventListener("click", runSearch);

    // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ q ã§èµ·å‹•
    (function bootFromQueryParam() {
      const params = new URLSearchParams(window.location.search);
      const q = (params.get("q") || "").trim();
      if (!q) return;

      const keywordInput = document.getElementById("keyword");
      keywordInput.value = q;
      keywordInput.focus();

      setTimeout(() => runSearch(), 50);
    })();

    // =========================================================
    // æç”»ï¼‹ã‚³ãƒ”ãƒ¼ï¼‹æ™‚é–“å‰µå‡ºï¼ˆå›ºå®š106ç§’ï¼‰ï¼‹è‡ªå‹•ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
    // =========================================================
    function formatMinutesSeconds(sec) {
      const s = Math.max(0, Math.round(sec));
      const m = Math.floor(s / 60);
      const r = s % 60;
      if (m <= 0) return `${r}ç§’`;
      return `${m}åˆ†${r}ç§’`;
    }

    function buildValueMessageFixed() {
      const perSearchSec = CREATED_SECONDS_FIXED;

      const dailySec = perSearchSec * DAILY_SEARCH_COUNT;
      const dailyMin = Math.round(dailySec / 60);

      const monthlyHours = (dailySec * 30) / 3600;
      const yearlyHours  = (dailySec * 365) / 3600;

      const yearlyWage = Math.round(yearlyHours * HOURLY_WAGE);

      const repairCount  = Math.floor(yearlyHours * REPAIR_PER_HOUR);
      const repairProfit = repairCount * PROFIT_PER_REPAIR;

      const privateDays = Math.round(yearlyHours / PRIVATE_HOURS_PER_DAY);

      return `
        <hr style="margin:16px 0;">
        <p style="margin:0 0 10px 0; font-weight:bold;">æœ¬ãƒ„ãƒ¼ãƒ«ã®æ™‚é–“ï¼ˆä¾¡å€¤ï¼‰åŠ¹æœã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚</p>

        <p style="margin:0 0 8px 0;"><strong>â± æ™‚é–“å‰µå‡ºï¼ˆç›®å®‰ï¼‰</strong></p>
        <ul class="small" style="margin-top:0;">
          <li>ä»Šå›ã®æ¤œç´¢ï¼šç´„ <strong>${formatMinutesSeconds(perSearchSec)}</strong></li>
          <li>1æ—¥10å›ãªã‚‰ï¼šç´„ <strong>${dailyMin} åˆ†ï¼æ—¥</strong></li>
          <li>1ã‹æœˆãªã‚‰ï¼šç´„ <strong>${monthlyHours.toFixed(1)} æ™‚é–“ï¼æœˆ</strong></li>
          <li>1å¹´ãªã‚‰ï¼šç´„ <strong>${yearlyHours.toFixed(0)} æ™‚é–“ï¼å¹´</strong></li>
        </ul>

        <p style="margin:12px 0 8px 0;"><strong>ğŸ’° æ™‚çµ¦æ›ç®—ï¼ˆæ™‚çµ¦ ${HOURLY_WAGE.toLocaleString()} å††ï¼‰</strong></p>
        <ul class="small" style="margin-top:0;">
          <li>å¹´é–“ï¼š<strong>${yearlyWage.toLocaleString()} å††</strong> ç›¸å½“</li>
        </ul>

        <p style="margin:12px 0 8px 0;"><strong>ğŸ”§ ãƒªãƒšã‚¢æ›ç®—ï¼ˆ1æ™‚é–“1å€‹ï¼1å€‹åˆ©ç›Š ${PROFIT_PER_REPAIR.toLocaleString()} å††ï¼‰</strong></p>
        <ul class="small" style="margin-top:0;">
          <li>å¹´é–“ï¼š${repairCount.toLocaleString()} å€‹ã®ãƒªãƒšã‚¢ãŒå¯èƒ½</li>
          <li>æ¨å®šåˆ©ç›Šï¼š<strong>${repairProfit.toLocaleString()} å††</strong></li>
        </ul>

        <p style="margin:12px 0 8px 0;"><strong>ğŸ• ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆæ›ç®—</strong></p>
        <ul class="small" style="margin-top:0;">
          <li>å¹´é–“ï¼šå®¶æ—å¤–å‡ºï¼ˆ7æ™‚é–“ï¼‰ãªã‚‰ï¼šç´„ <strong>${privateDays.toLocaleString()} å›</strong>åˆ†ã®æ€ã„å‡ºãŒä½œã‚Œã‚‹</li>
        </ul>

        <p class="small" style="margin:12px 0 0 0;">
          â€» ä¸Šè¨˜ã¯ä½œè€…ãŒPCã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ5ã‚µã‚¤ãƒˆã‚’ä¸€ã¤ãšã¤æ¤œç´¢ã—ãŸå ´åˆã¨æœ¬ãƒ„ãƒ¼ãƒ«ã§ä¸€æ‹¬æ¤œç´¢ã—ãŸå ´åˆã®å®Ÿæ¸¬å€¤ã‚’ã‚‚ã¨ã«ã—ãŸæ™‚çŸ­åŠ¹æœã®ç›®å®‰ã§ã™ã€‚æ“ä½œç’°å¢ƒã‚„æ…£ã‚Œã«ã‚ˆã‚Šå‰å¾Œã—ã¾ã™ã€‚
        </p>
      `;
    }

    function renderLinks(links, keyword) {
      const resultDiv = document.getElementById("result");
      const resultLinks = document.getElementById("resultLinks");

      if (!links || links.length === 0) {
        resultDiv.style.display = "none";
        resultLinks.innerHTML = "";
        return;
      }

      let html = '<ul class="result-list">';
      links.forEach(link => {
        html += `
          <li>
            <a class="result-link" href="${link.url}" target="_blank" rel="noopener noreferrer">
              <strong>${link.label}</strong>
            </a>
          </li>
        `;
      });
      html += "</ul>";

      // ã‚³ãƒ”ãƒ¼ç”¨
      let copyText = "";
      copyText += `â– æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼š${keyword}\n\n`;
      links.forEach(link => {
        copyText += `${link.label}\n${link.url}\n\n`;
      });

      html += `
        <p style="margin-top:12px; font-weight:bold;">ã‚³ãƒ”ãƒ¼ç”¨ï¼ˆãƒãƒ£ãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãªã©ã«ä¿å­˜ã—ãŸã„ã¨ãï¼‰</p>
        <p class="small">â€» ã€Œã“ã®çµæœã‚’ã‚³ãƒ”ãƒ¼ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã€ãƒãƒ£ãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚„ãƒ¡ãƒ¢ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚</p>
        <button type="button" id="copyBtn">ã“ã®çµæœã‚’ã‚³ãƒ”ãƒ¼</button>
        <textarea class="copy-area" id="copyArea" readonly>${copyText}</textarea>
      `;

      // â˜… æ™‚é–“å‰µå‡ºï¼ˆå›ºå®š106ç§’ï¼‰
      html += buildValueMessageFixed();

      resultLinks.innerHTML = html;
      resultDiv.style.display = "block";

      // â˜… è‡ªå‹•ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼ˆã‚¹ãƒãƒ›/PCï¼‰
      requestAnimationFrame(() => {
        resultDiv.scrollIntoView({ behavior: "smooth", block: "start" });
      });

      // ã‚³ãƒ”ãƒ¼å‡¦ç†
      const copyBtn = document.getElementById("copyBtn");
      const copyArea = document.getElementById("copyArea");

      if (copyBtn && copyArea) {
        copyBtn.addEventListener("click", function () {
          const text = copyArea.value;

          if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(text)
              .then(() => alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸã€‚ãƒãƒ£ãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚„ãƒ¡ãƒ¢ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚"))
              .catch(() => {
                copyArea.focus();
                copyArea.select();
                document.execCommand("copy");
                alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸã€‚ãƒãƒ£ãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚„ãƒ¡ãƒ¢ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚");
              });
          } else {
            copyArea.focus();
            copyArea.select();
            document.execCommand("copy");
            alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸã€‚ãƒãƒ£ãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚„ãƒ¡ãƒ¢ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚");
          }
        });
      }
    }
  </script>
</body>
</html>
