<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>マルチサイト一括リサーチツール</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 16px;
      line-height: 1.6;
    }
    h1 {
      font-size: 1.4rem;
      margin-bottom: 0.5rem;
    }
    .card {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 16px;
      margin-top: 12px;
    }
    label {
      display: inline-block;
      margin-right: 12px;
      margin-bottom: 4px;
    }
    input[type="text"] {
      width: 100%;
      padding: 8px;
      font-size: 1rem;
      box-sizing: border-box;
    }
    button {
      padding: 10px 18px;
      font-size: 1rem;
      cursor: pointer;
      border-radius: 6px;
      border: none;
      background: #2563eb;
      color: #fff;
      margin-top: 12px;
    }
    button:disabled {
      background: #9ca3af;
      cursor: default;
    }
    .small {
      font-size: 0.85rem;
      color: #555;
    }
    ul.result-list {
      list-style: none;
      padding-left: 0;
      margin: 0;
      margin-top: 8px;
    }
    ul.result-list li {
      margin-bottom: 10px;
    }
    a.result-link {
      font-size: 0.95rem;
      text-decoration: underline;
      color: #2563eb;
    }
  </style>
</head>
<body>
  <h1>マルチサイト一括リサーチツール</h1>
  <p class="small">
    キーワードを1回入力して、複数サイト（eBay／ヤフオク／メルカリ／ラクマ／ヤフーショッピング／Amazon／Etsy）をまとめてリサーチするツールです。<br>
    「美品（Mint）を付ける」をONにすると、eBayは <code>mint</code>、日本サイトは <code>美品</code> を末尾に付けて検索します。<br>
    ※一部サイト（ヤフーショッピング／Amazon.co.jp／Amazon.com／Etsy）は、状態ワードを付けるとヒットが激減するため、あえて状態ワードを付けない仕様にしています。
  </p>

  <div class="card">
    <div>
      <label for="keyword"><strong>キーワード</strong></label>
      <input type="text" id="keyword" placeholder="例：Nikon D750 50mm f1.8 など">
    </div>

    <div style="margin-top: 12px;">
      <label>
        <input type="checkbox" id="checkMint" checked>
        美品（Mint）を付ける
      </label>
      <div class="small">
        ・ON：eBay →「 mint」、ヤフオク／メルカリ／ラクマ →「 美品」を末尾に付与。<br>
        ・OFF：素のキーワードのみで検索。<br>
        ・ヤフーショッピング／Amazon.co.jp／Amazon.com／Etsy は、美品モードONでも状態ワードを付けません。
      </div>
    </div>

    <div style="margin-top: 12px;">
      <div><strong>検索するサイト</strong></div>
      <label><input type="checkbox" id="useEbay" checked> eBay</label>
      <label><input type="checkbox" id="useYahu" checked> ヤフオク</label><br>
      <label><input type="checkbox" id="useMercari"> メルカリ</label>
      <label><input type="checkbox" id="useRakuma"> ラクマ</label><br>
      <label><input type="checkbox" id="useYahuShop"> ヤフーショッピング</label><br>
      <label><input type="checkbox" id="useAmaJP"> Amazon.co.jp</label>
      <label><input type="checkbox" id="useAmaUS"> Amazon.com</label><br>
      <label><input type="checkbox" id="useEtsy"> Etsy</label>

      <div class="small" style="margin-top:4px;">
        ※ブラウザのポップアップブロックが有効だと、複数タブがブロックされる場合があります。その際はアドレスバー付近の「ポップアップ許可」をオンにしてください。
      </div>
    </div>

    <button id="runBtn">検索</button>
  </div>

  <div id="result" class="card" style="display:none; margin-top:16px;">
    <strong>リンク一覧（スマホ／PC共通）</strong>
    <div id="resultLinks" class="small" style="margin-top:8px;"></div>
  </div>

  <script>
    function openInNewTab(url) {
      window.open(url, "_blank");
    }

    document.getElementById("runBtn").addEventListener("click", function () {
      const keywordInput = document.getElementById("keyword");
      const keyword = keywordInput.value.trim();

      if (!keyword) {
        alert("キーワードを入力してください。");
        keywordInput.focus();
        return;
      }

      const checkMint = document.getElementById("checkMint").checked;

      const useEbay    = document.getElementById("useEbay").checked;
      const useYahu    = document.getElementById("useYahu").checked;
      const useMercari = document.getElementById("useMercari").checked;
      const useRakuma  = document.getElementById("useRakuma").checked;
      const useYahuShop= document.getElementById("useYahuShop").checked;
      const useAmaJP   = document.getElementById("useAmaJP").checked;
      const useAmaUS   = document.getElementById("useAmaUS").checked;
      const useEtsy    = document.getElementById("useEtsy").checked;

      if (!useEbay && !useYahu && !useMercari && !useRakuma &&
          !useYahuShop && !useAmaJP && !useAmaUS && !useEtsy) {
        alert("少なくとも1つのサイトを選択してください。");
        return;
      }

      // -------------------------------------------
      // キーワードバリエーション（AHK版と同じロジック）
      // -------------------------------------------
      const plainWord = keyword; // 状態ワードなし

      let ebayWord, jpWord;
      if (checkMint) {
        // eBay用は " mint" を付与
        ebayWord = keyword + " mint";
        // 日本サイト用は「 美品」を付与
        jpWord   = keyword + " 美品";
      } else {
        ebayWord = keyword;
        jpWord   = keyword;
      }

      const plainUrlWord = encodeURIComponent(plainWord);
      const ebayUrlWord  = encodeURIComponent(ebayWord);
      const jpUrlWord    = encodeURIComponent(jpWord);

      const links = []; // {label, url} を貯める

      // =========================
      // eBay
      // =========================
      if (useEbay) {
        // AHK版コメント：
        // ★ eBayソールド高値順のテンプレURL（TESTWORD を残す）
        const baseEbay =
          "https://www.ebay.com/sch/i.html?_nkw=TESTWORD&_sacat=0&_from=R40&LH_Sold=1&LH_Complete=1&_sop=16";
        const urlEbay = baseEbay.replace("TESTWORD", ebayUrlWord);
        links.push({ label: "eBay（SOLD・高い順）", url: urlEbay });
      }

      // =========================
      // ヤフオク
      // =========================
      if (useYahu) {
        // AHK版コメント：
        // ★ ヤフオク落札相場・高い順
        //   → 美品モードONなら「キーワード + 美品」で検索
        const baseYahu =
          "https://auctions.yahoo.co.jp/closedsearch/closedsearch?p=TESTWORD&va=TESTWORD&b=1&n=100&select=2";
        const urlYahu = baseYahu.replace(/TESTWORD/g, jpUrlWord);
        links.push({ label: "ヤフオク落札相場（高い順）", url: urlYahu });
      }

      // =========================
      // メルカリ
      // =========================
      if (useMercari) {
        // AHK版コメント：
        // ★ メルカリ売り切れ（SOLD）・高い順
        //   → 美品モードONなら「キーワード + 美品」
        const baseMercari =
          "https://jp.mercari.com/search?keyword=TESTWORD&status=sold_out%7Ctrading&sort=price&order=desc";
        const urlMercari = baseMercari.replace("TESTWORD", jpUrlWord);
        links.push({ label: "メルカリ（売り切れ・高い順）", url: urlMercari });
      }

      // =========================
      // ラクマ
      // =========================
      if (useRakuma) {
        // AHK版コメント：
        // ★ ラクマ売り切れ・価格高い順
        //   → 美品モードONなら「キーワード + 美品」
        const baseRakuma =
          "https://fril.jp/s?order=desc&query=TESTWORD&sort=sell_price&transaction=soldout";
        const urlRakuma = baseRakuma.replace("TESTWORD", jpUrlWord);
        links.push({ label: "ラクマ（売り切れ・高い順）", url: urlRakuma });
      }

      // =========================
      // ヤフーショッピング
      // =========================
      if (useYahuShop) {
        // AHK版コメント：
        // ★ ヤフーショッピング検索
        //   【仕様】美品モードがONでも「美品」は付けない。
        //           状態ワードを入れるとヒットが激減するため、
        //           あえて「素のキーワード（plainWord）」のみで検索。
        const baseYahuShop =
          "https://shopping.yahoo.co.jp/search?first=1&tab_ex=commerce&fr=shp-prop&mcr=61c1e36d2245f2f47a36cdc31b5de2df&ts=1764813874&sretry=1&p=TESTWORD&sc_i=shopping-pc-web-top--h_srch-kwd&area=11";
        const urlYahuShop = baseYahuShop.replace(/TESTWORD/g, plainUrlWord);
        links.push({ label: "ヤフーショッピング", url: urlYahuShop });
      }

      // =========================
      // Amazon.co.jp
      // =========================
      if (useAmaJP) {
        // AHK版コメント：
        // ★ Amazon.co.jp 検索
        //   【仕様】美品モードがONでも「美品」は付けない。
        //           状態ワードを入れると検索結果が極端に減るため、
        //           あえて「素のキーワード（plainWord）」で検索。
        const baseAmaJP =
          "https://www.amazon.co.jp/s?k=TESTWORD&__mk_ja_JP=%E3%82%AB%E3%82%BF%E3%82%AB%E3%83%8A&crid=3VVGYVWD090II&sprefix=TESTWORD%2Caps%2C184&ref=nb_sb_noss_1";
        const urlAmaJP = baseAmaJP.replace(/TESTWORD/g, plainUrlWord);
        links.push({ label: "Amazon.co.jp", url: urlAmaJP });
      }

      // =========================
      // Amazon.com
      // =========================
      if (useAmaUS) {
        // AHK版コメント：
        // ★ Amazon.com 検索
        //   【仕様】美品モードがONでも "mint" は付けない。
        //           "mint" を付けるとヒットが激減するため、
        //           あえて「素のキーワード（plainWord）」で検索。
        const baseAmaUS =
          "https://www.amazon.com/s?k=TESTWORD&crid=311FN96333MS3&sprefix=TESTWORD+%2Caps%2C281&ref=nb_sb_noss_2";
        const urlAmaUS = baseAmaUS.replace(/TESTWORD/g, plainUrlWord);
        links.push({ label: "Amazon.com", url: urlAmaUS });
      }

      // =========================
      // Etsy
      // =========================
      if (useEtsy) {
        // AHK版コメント：
        // ★ Etsy 検索
        //   【仕様】美品モードがONでも "mint" は付けない。
        //           状態ワードで絞りすぎると出品がほとんど出なくなるため、
        //           あえて「素のキーワード（plainWord）」だけで検索。
        const baseEtsy =
          "https://www.etsy.com/jp/search?q=TESTWORD&order=price_desc";
        const urlEtsy = baseEtsy.replace("TESTWORD", plainUrlWord);
        links.push({ label: "Etsy（価格高い順）", url: urlEtsy });
      }

      // -------- タブ自動オープン --------
      links.forEach(link => {
        openInNewTab(link.url);
      });

      // -------- 下部にリンク一覧も表示 --------
      renderLinks(links);
    });

    function renderLinks(links) {
      const resultDiv = document.getElementById("result");
      const resultLinks = document.getElementById("resultLinks");

      if (!links || links.length === 0) {
        resultDiv.style.display = "none";
        resultLinks.innerHTML = "";
        return;
      }

      let html = '<ul class="result-list">';
      links.forEach(link => {
        html += `
          <li>
            <a class="result-link" href="${link.url}" target="_blank" rel="noopener noreferrer">
              <strong>${link.label}</strong>
            </a>
          </li>
        `;
      });
      html += "</ul>";

      resultLinks.innerHTML = html;
      resultDiv.style.display = "block";
    }
  </script>
</body>
</html>
